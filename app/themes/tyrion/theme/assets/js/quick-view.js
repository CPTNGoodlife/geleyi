(function(a){var f;f=a.event.special.throttledresize={setup:function(){a(this).on("resize",f.handler)},teardown:function(){a(this).off("resize",f.handler)},handler:function(a,f){wasResized=!0},threshold:0};var s=function(){var g;function f(c){h.each(function(){var b=a(this);b.data("offsetTop",b.offset().top);c&&b.data("height",b.height())})}function s(){t(h);k.on("throttledresize",function(){n=0;p=-1;f();k.width();g=k.height();"undefined"!=typeof a.data(this,"preview")&&q()})}function t(c){c.on("click",
    "span.og-close",function(){q();return!1}).on("click","a.thumb",function(b){if(767<a(window).width())return b=a(this).parents("li.product"),l===b.index()?q():w(b),!1})}function w(c){a(".woocommerce-message").hide();var b=a.data(this,"preview"),d=c.data("offsetTop");n=0;if("undefined"!=typeof b)if(p!==d)d>p&&(n=b.height),q();else return b.update(c),!1;p=d;b=a.data(this,"preview",new u(c));b.open()}function q(){l=-1;a.data(this,"preview").close();a.removeData(this,"preview")}function u(a){this.$item=
    a;this.expandedIdx=this.$item.index();this.create();this.update()}var v=a("ul.products:not(.yit_products_slider)"),h=v.children("li.product"),l=-1,p=-1,n=0,k=a(window),x=a("html, body"),r={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[Modernizr.prefixed("transition")],m=Modernizr.csstransitions,e={minHeight:500,speed:350,easing:"ease"};u.prototype={create:function(){this.$productContainer=
    a('<div class="productWrapper" />');this.$closePreview=a('<span class="og-close" />');this.$previewInner=a('<div class="og-expander-inner" />').append(this.$closePreview,this.$productContainer);this.$previewEl=a('<div class="og-expander single-product woocommerce" />').append(this.$previewInner);this.$item.append(this.getEl());m&&this.setTransition()},update:function(c){c&&(this.$item=c);-1!==l&&(h.eq(l).removeClass("og-expanded"),this.$item.addClass("og-expanded"),this.positionPreview());l=this.$item.index();
    var b=this.$item.find("a.thumb").attr("href"),d=this;d.$productContainer.html('<div class="quick-view-loading" />');a.get(b,{doing_ajax:1},function(c){d.$productContainer.html(c).addClass("group").imagesLoaded(function(){var a=d.$item.siblings(":first").outerHeight(),a=a?a:470;d.itemMinHeight=a;d.$previewEl.height(d.itemHeight);d.$item.height(a+d.itemHeight-50)});var e=d.$productContainer.find("form.variations_form").wc_variation_form(),f=e.find('.variations select[data-type="select"]');f.selectbox({effect:"fade"}).change();
        e.find(".reset_variations").on("click",function(b){e.data("wccl")||f.each(function(){a(this).selectbox("detach").removeAttr("sb").val("");a(this).selectbox("attach")})});e.data("wccl")&&e.yith_wccl();d.$productContainer.find("div.quantity:not(.buttons_added), td.quantity:not(.buttons_added)").addClass("buttons_added").append("<input type='button' value='+' class='plus' />").prepend("<input type='button' value='-' class='minus' />");d.$productContainer.find(".product-actions a.add_to_wishlist, .product-actions a.compare").each(function(){a(this).tipTip({defaultPosition:"bottom",
            maxWidth:"auto",edgeOffset:20,content:a(this).text()})});"undefined"!=typeof a.prettyPhoto&&(d.$productContainer.find("#review_form_wrapper").hide(),d.$productContainer.find("a.zoom").prettyPhoto({social_tools:!1,theme:"pp_woocommerce",horizontal_padding:40,opacity:0.9,deeplinking:!1}),d.$productContainer.find("a.show_review_form").prettyPhoto({social_tools:!1,theme:"pp_woocommerce",horizontal_padding:40,opacity:0.9,deeplinking:!1}),d.$productContainer.find("a[rel^='thumbnails']").prettyPhoto({social_tools:!1,
            theme:"pp_woocommerce",horizontal_padding:40,opacity:0.9,deeplinking:!1}),"#review_form"==window.location.hash&&d.$productContainer.find("a.show_review_form").trigger("click"));d.$productContainer.find("form.cart").on("submit",function(c){c.preventDefault();c=a(this);c.find("button");d.$productContainer.block({message:null,overlayCSS:{background:"#fff url("+woocommerce_params.plugin_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:0.3,cursor:"none"}});a.post(c.attr("action"),c.serialize()+
            "&_wp_http_referer="+b,function(c){var b=a(".woocommerce-message",c);c=a("#header .yit_cart_widget",c);a("#header .yit_cart_widget").replaceWith(c);a.ajax($fragment_refresh);d.$productContainer.before(b);d.$previewEl.height(d.$previewEl.height()+b.outerHeight(!0));d.$item.height(d.$item.height()+b.outerHeight(!0));d.$closePreview.insertBefore(d.$productContainer);d.$productContainer.unblock()})});a(document).trigger("yit-quick-view-loaded")})},open:function(){setTimeout(a.proxy(function(){this.setHeights();
    this.positionPreview()},this),25)},close:function(){var c=this,b=function(){m&&a(this).off(r);c.$item.removeClass("og-expanded");c.$previewEl.remove();a("ul.products:not(.yit_products_slider) li.product").removeAttr("style")};setTimeout(a.proxy(function(){"undefined"!==typeof this.$largeImg&&this.$largeImg.fadeOut("fast");this.$previewEl.css("height",0);var a=h.eq(this.expandedIdx);a.css("height",a.data("height")).on(r,b);m||b.call()},this),25);return!1},calcHeight:function(){var a=g-this.$item.data("height")-
    10,b=g;a<e.minHeight&&(a=e.minHeight,b=e.minHeight+this.$item.data("height")+10);this.height=a;this.itemHeight=b},setHeights:function(){var a=this,b=function(){m&&a.$item.off(r);a.$item.addClass("og-expanded")};this.calcHeight();this.$previewEl.css("height",this.height);this.$item.css("height",this.itemHeight).on(r,b);m||b.call()},positionPreview:function(){var a=this.$item.data("offsetTop"),b=this.$previewEl.offset().top-n,a=this.height+this.$item.data("height")+10<=g?a:this.height<g?b-(g-this.height):
    b;x.animate({scrollTop:a},e.speed)},setTransition:function(){this.$previewEl.css("transition","height "+e.speed+"ms "+e.easing);this.$item.css("transition","height "+e.speed+"ms "+e.easing)},getEl:function(){return this.$previewEl}};return{init:function(c){e=a.extend(!0,{},e,c);v.imagesLoaded(function(){f(!0);k.width();g=k.height();s()})},addItems:function(c){h=h.add(c);c.each(function(){var b=a(this);b.data({offsetTop:b.offset().top,height:b.height()})});t(c)}}}();s.init();a(document).on("yith-wcan-ajax-filtered",
    function(){s.addItems(a("ul.products:not(.yit_products_slider) li.product"))})})(jQuery);